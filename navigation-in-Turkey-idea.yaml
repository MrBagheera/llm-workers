models:
  - name: default
#    provider: ollama
#    model: llama3.3
#    model: deepseek-r1:70b
    provider: openai
    model: gpt-4o

tools:
  - llm_workers.tools.fetch.fetch_page_markdown

custom_tools:
  - name: generate_navigation_summary
    description: >
      Generates a summary of navigation information from a web page.
      Summary is returned as text string, not saved anywhere.
    input:
      - name: url
        description: URL of the page to summarize
        type: str
    body:
      - call: fetch_page_markdown
        params:
          url: "{input.url}"
      - call: llm
        params:
          prompt: |
            You are an assistant to a sailing boat navigator.
            
            Please write summary of a text below in English, use ONLY the information from provided text.
            Format using markdown with headers starting form level 3, and follow this structure:
              - title
              - coordinates
              - services and docking information (for marinas) or anchoring recommendations and protection offered (for anchorages)
              - navigational hazards
              - other information relevant to boating
            
            Text to summarize:
            {last_result}
#    return_direct: true

cli:
  - call: fetch_page_markdown
    params:
      url: "{input}"
  - call: llm
    params:
      prompt: |
        Please examine the text below list and links under section "KOY". List only first 3 URLs, one on a line, without any extra text or formatting.
        
        Text:
        {last_result}
  - for_each: "{last_result}"
    split_on: "\n"
    do:
      - call: fetch_page_markdown
        params:
          url: "{element}"
      - call: llm
        params:
          prompt: |
            You are an assistant to a sailing boat navigator.
            
            Please write summary of a text below in English, use ONLY the information from provided text.
            Format using markdown with headers starting form level 3, and follow this structure:
              - title
              - coordinates
              - services and docking information (for marinas) or anchoring recommendations and protection offered (for anchorages)
              - navigational hazards
              - other information relevant to boating
            
            Text to summarize:
            {last_result}
    merge_with: "\n\n"

chat:
  system_message: >
    You are an assistant to a sailing boat navigator.
    
    When asked to provide summary for a given text, please write summary in English, use ONLY the information from provided text.
    Format using markdown with headers starting form level 3, and follow this structure:
       - title
       - coordinates
       - services and docking information (for marinas) or anchoring recommendations and protection offered (for anchorages
       - navigational hazards
       - other information relevant to boating
  default_prompt: >
    Please fetch the page from https://www.coastguidetr.com/tr/korfez/1009/yesilova-korfezi-kadirga-burnu-arasi and list links under section "KOY"
  tool_refs:
    - fetch_page_markdown
